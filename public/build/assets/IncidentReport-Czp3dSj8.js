import{A as M}from"./AppLayout-CdKr8ESd.js";import{r as u,T as V,s as f,c as E,w as _,o as l,a as e,k as g,x as R,A as k,b as T,f as y,d,F as I,g as P,e as c,t as i}from"./app-BlA7PXUo.js";import{V as N}from"./main-DLK7fOAX.js";import{M as j}from"./vue3-multiselect.umd.min-BmnbD0fr.js";import{P as O}from"./Pagination-BbMbld6b.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Zok9paaL.js";const A={name:"IncidentReport",components:{AppLayout:M,Pagination:O,VueDatePicker:N,Multiselect:j},props:{incidents:Object},setup(C){u(null),u(!1);const t=u(!1),a=u({date:"YYYY-MM-DD",month:"MMM"}),o=V({general:null,type:0,status:0,period:null}),b=()=>{o.reset()};function h(){o.post("/incidentReport",{onSuccess:s=>{t.value=!1},onError:s=>{t.value=!1,console.log(s)},onStart:()=>{t.value=!0}},{preserveState:!0})}function m(s){let n="Open";return s==1?n="Open":s==2?n="Escalated":s==3?n="Closed":s==4?n="Deleted":s==5&&(n="Resolved"),n}return{getStatus:m,loading:t,formatter:a,form:o,submit:h,doExcel:()=>{axios.post("/exportIncidentReportExcel",o,{responseType:"blob"}).then(s=>{console.log(s);var n=document.createElement("a");document.body.appendChild(n),n.style="display: none";var x=new Blob([s.data],{type:s.headers["content-type"]});const r=document.createElement("a");r.href=window.URL.createObjectURL(x),r.download=`incidents_${new Date().getTime()}.xlsx`,r.click()})},showTime:s=>{var n=!(s/60<1),x=!(s/60<24);if(x||n){var r=s/60/24,p=r-Math.floor(r),S=r-p,D=(p*24-Math.floor(p*24))*60;return S+"d "+Math.round(p*24)+"h:"+Math.round(D)+"m"}else return Math.round(s)+"m"},clearSearch:b}}},B={class:"py-2"},L={class:"max-w-full mx-auto sm:px-6 lg:px-8 mt-4"},Y={class:"bg-white shadow sm:rounded-t-lg flex justify-between space-x-2 items-end py-2 px-2 md:px-2"},z={class:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full"},F={class:"py-2 col-span-1 sm:col-span-1"},G={class:"mt-1 flex rounded-md shadow-sm"},q={class:"py-2 col-span-1 sm:col-span-1"},H={class:"mt-1 flex rounded-md shadow-sm"},J={class:"py-2 col-span-1 sm:col-span-1"},K={class:"mt-1 flex rounded-md shadow-sm"},Q={class:"py-2 col-span-1 sm:col-span-1"},W={class:"mt-1 flex rounded-md shadow-sm"},X={class:"mb-2 py-2 px-2 md:px-2 bg-white shadow rounded-b-lg flex justify-between"},Z={class:"flex"},$={class:"flex"},ee={key:0,class:"max-w-full mx-auto sm:px-6 lg:px-8 mt-4"},te={key:0,class:"bg-white overflow-visible shadow-xl sm:rounded-lg"},se={class:"min-w-full divide-y divide-gray-200"},oe={class:"bg-white divide-y divide-gray-200 relative"},ne={class:"pl-4 px-2 py-3 text-xs whitespace-nowrap"},ae={class:"px-2 py-3 text-xs whitespace-nowrap"},ie={class:"px-2 py-3 text-xs whitespace-nowrap"},le={class:"px-2 py-3 text-xs whitespace-nowrap capitalize"},re={class:"px-2 py-3 text-xs whitespace-nowrap"},de={class:"px-2 py-3 text-xs whitespace-nowrap"},ce={class:"px-2 py-3 text-xs whitespace-nowrap"},pe={key:1,class:"w-full block mt-4"},ue={class:"text-xs text-gray-600"},me={key:2},xe={key:3,"wire:loading":"",class:"fixed top-0 left-0 right-0 bottom-0 w-full h-screen z-50 overflow-hidden bg-gray-700 opacity-75 flex flex-col items-center justify-center"};function fe(C,t,a,o,b,h){const m=f("VueDatePicker"),w=f("pagination"),v=f("app-layout");return l(),E(v,null,{header:_(()=>t[7]||(t[7]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"},"Ticket Report",-1)])),default:_(()=>[e("div",B,[e("div",L,[e("div",Y,[e("div",z,[e("div",F,[t[9]||(t[9]=e("label",{for:"sh_general",class:"block text-sm font-medium text-gray-700"},"General ",-1)),e("div",G,[t[8]||(t[8]=e("span",{class:"z-10 leading-snug font-normal text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),g(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>o.form.general=s),name:"sh_general",id:"sh_general",class:"pl-10 py-2.5 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Ticket ID/Customer ID/Customer Name etc.",tabindex:"1"},null,512),[[R,o.form.general]])])]),e("div",q,[t[11]||(t[11]=e("label",{for:"sh_type",class:"block text-sm font-medium text-gray-700"},"Ticket Type ",-1)),e("div",H,[g(e("select",{id:"sh_type","onUpdate:modelValue":t[1]||(t[1]=s=>o.form.type=s),name:"sh_type",class:"py-2.5 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",tabindex:"2"},t[10]||(t[10]=[e("option",{value:"0",selected:""},"All",-1),e("option",{value:"service_complaint"},"Service Complaint",-1),e("option",{value:"onsite_complaint"},"Onsite Complaint",-1),e("option",{value:"technical_complaint"},"Technical Complaint",-1),e("option",{value:"plan_change"},"Plan Change",-1),e("option",{value:"suspension"},"Suspension",-1),e("option",{value:"termination"},"Termination",-1)]),512),[[k,o.form.type]])])]),e("div",J,[t[12]||(t[12]=e("label",{for:"sh_period",class:"block text-sm font-medium text-gray-700"},"Period ",-1)),e("div",K,[T(m,{modelValue:o.form.period,"onUpdate:modelValue":t[2]||(t[2]=s=>o.form.period=s),range:{partialRange:!0},placeholder:"Please choose Ticket Range","enable-time-picker":!1,"model-type":"yyyy-MM-dd",id:"order_date",class:"text-gray-400 text-sm focus:ring focus:ring-indigo-500 focus:border-indigo-500 focus:ring-opacity-10 focus:outline-none"},null,8,["modelValue"])])]),e("div",Q,[t[14]||(t[14]=e("label",{for:"sh_type",class:"block text-sm font-medium text-gray-700"},"Ticket Status ",-1)),e("div",W,[g(e("select",{id:"sh_type","onUpdate:modelValue":t[3]||(t[3]=s=>o.form.status=s),name:"sh_status",class:"py-2.5 block w-full px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",tabindex:"4"},t[13]||(t[13]=[e("option",{value:"0"},"All Status",-1),e("option",{value:"1"},"Open",-1),e("option",{value:"2"},"Escalated",-1),e("option",{value:"5"},"Resolved",-1),e("option",{value:"3"},"Closed",-1),e("option",{value:"4"},"Deleted",-1)]),512),[[k,o.form.status]])])])])]),e("div",X,[e("div",Z,[e("a",{onClick:t[4]||(t[4]=(...s)=>o.submit&&o.submit(...s)),class:"cursor-pointer inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring focus:ring-gray-300 disabled:opacity-25 transition"},t[15]||(t[15]=[y("Search "),e("i",{class:"ml-1 fa fa-search text-white",tabindex:"10"},null,-1)])),e("a",{onClick:t[5]||(t[5]=(...s)=>o.clearSearch&&o.clearSearch(...s)),class:"ml-2 cursor-pointer inline-flex items-center px-4 py-2 bg-gray-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-400 active:bg-gray-500 focus:outline-none focus:border-gray-500 focus:ring focus:ring-gray-200 disabled:opacity-25 transition"},t[16]||(t[16]=[y("Reset "),e("i",{class:"ml-1 fa fa-undo-alt text-white",tabindex:"11"},null,-1)]))]),e("div",$,[e("a",{onClick:t[6]||(t[6]=(...s)=>o.doExcel&&o.doExcel(...s)),class:"cursor-pointer inline-flex items-center px-4 py-2 bg-green-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-900 focus:outline-none focus:border-green-900 focus:ring focus:ring-green-300 disabled:opacity-25 transition"},t[17]||(t[17]=[y("Export Excel "),e("i",{class:"ml-1 fa fa-download text-white",tabindex:"11"},null,-1)]))])])]),a.incidents?(l(),d("div",ee,[a.incidents.data?(l(),d("div",te,[e("table",se,[t[18]||(t[18]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"pl-3 px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," No."),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ticket ID"),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer ID"),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ticket Type"),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ticket Start Date"),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ticket Close Date"),e("th",{scope:"col",class:"px-2 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status")])],-1)),e("tbody",oe,[(l(!0),d(I,null,P(a.incidents.data,(s,n)=>(l(),d("tr",{key:s.id},[e("td",ne,i(n+=a.incidents.from),1),e("td",ae,i(s.code),1),e("td",ie,i(s.ftth_id),1),e("td",le,i(s.type.replace(/_/g," ")),1),e("td",re,i(s.date)+" "+i(s.time),1),e("td",de,i(s.close_date)+" "+i(s.close_time),1),e("td",ce,i(o.getStatus(s.status)),1)]))),128))])])])):c("",!0),a.incidents.total?(l(),d("span",pe,[e("label",ue,i(a.incidents.data.length)+" Invoices in Current Page. Total Number of Invoices : "+i(a.incidents.total),1)])):c("",!0),a.incidents.links?(l(),d("span",me,[T(w,{class:"mt-6",links:a.incidents.links},null,8,["links"])])):c("",!0),o.loading?(l(),d("div",xe,t[19]||(t[19]=[e("div",{class:"loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"},null,-1),e("h2",{class:"text-center text-white text-xl font-semibold"},"Loading...",-1),e("p",{class:"w-1/3 text-center text-white"},"This may take a few seconds, please don't close this page.",-1)]))):c("",!0)])):c("",!0)])]),_:1})}const ke=U(A,[["render",fe]]);export{ke as default};
