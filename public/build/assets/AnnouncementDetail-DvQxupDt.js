import{A as O}from"./AppLayout-5S6LuvBy.js";import{P as N}from"./Pagination-B3nZN2FW.js";import{r as f,T as E,q as D,B as z,s as k,c as B,w as S,N as L,o as l,a as e,k as c,x as v,d as i,t as d,e as m,A as F,g as y,F as b,v as V,f as x,b as j,n as G}from"./app-BpUoshh9.js";import{M as I}from"./vue3-multiselect.umd.min-SsDtYRO9.js";import{S as q}from"./SmsGenerationProgress-CYQCvEfk.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DropdownLink-Ch80CFF4.js";const R={name:"Announcement",components:{AppLayout:O,Multiselect:I,Pagination:N,SmsGenerationProgress:q},props:{announcement:Object,templates:Object,customers:Object,packages:Object,projects:Object,townships:Object,package_speed:Object,status:Object,errors:Object},setup(r){const t=f(!1),p=f(""),a=f(!1),C=f(0),h=f(!1),n=E({id:null,name:null,general:null,template:0,package_except:null,package:null,type:null,township:0,status_except:null,status:null,partner:0,payment:0,deposit_status:0});function _(){n.id=null,n.name=null,n.general=null,n.template=0,n.package_except=null,n.package=null,n.type=null,n.township=0,n.status_except=null,n.status=null,n.partner=0,n.payment=0,n.deposit_status=0}function g(s){if(n.id=s.id,n.name=s.name,n.general=s.general,n.template=s.template_id,n.package_except=!!s.packages_invert,s.packages&&(n.package=JSON.parse(s.packages)),s.customer_status)if(s.customer_status.indexOf(",")!==-1){let u=s.customer_status.split(",");n.status=r.status.filter(w=>u.includes(""+w.id))}else n.status=r.status.filter(u=>""+u.id==s.customer_status);if(n.township=s.townships,n.status_except=!!s.customer_status_invert,n.partner=s.projects,n.payment=s.payment_type,n.deposit_status=s.deposit_status,n.template!=0){let u=r.templates.filter(w=>w.id==parseInt(n.template))[0];n.type=u.type}}function o(){if(n.template!=0){let s=r.templates.filter(u=>u.id==n.template)[0];n.type=s.type}}const T=()=>{n.post("/announcement/detail/"+n.id+"/update",{onSuccess:s=>{t.value=!1,Toast.fire({icon:"success",title:s.props.flash.message})},onError:s=>{console.log(s)}})},A=()=>{n.post("/announcement/detail/"+n.id,{onSuccess:s=>{t.value=!0},onError:s=>{t.value=!1,console.log(s)}})},U=()=>{n.post("/announcement/detail/"+n.id+"/send",{onSuccess:s=>{t.value=!1,a.value=!1,Toast.fire({icon:"success",title:s.props.flash.message})},onError:s=>{a.value=!1,console.log(s)},onStart:s=>{a.value=!0}})},P=s=>{confirm("Are you sure want to Delete?")&&(s._method="DELETE",L.post("/announcement/"+s.id,s))},M=s=>{s&&(h.value=!s)};return D(()=>{r.packages.map(function(s){return s.item_data=`${s.speed}Mbps - ${s.name} - ${s.contract_period} Months`}),r.package_speed.map(function(s){return s.item_data=`${s.speed} Mbps - ${s.type.toUpperCase()}`}),r.announcement&&g(r.announcement)}),z(()=>{r.packages.map(function(s){return s.item_data=`${s.speed}Mbps - ${s.name} - ${s.contract_period} Months`}),r.package_speed.map(function(s){return s.item_data=`${s.speed} Mbps - ${s.type.toUpperCase()}`}),r.announcement&&g(r.announcement)}),{deleteRow:P,doSearch:A,template_change:o,sort:p,search:t,createForm:n,loading:a,updateForm:T,resetCreateForm:_,formFill:g,sendAnnouncement:U,dismiss:M,announcementsms:C,showSmsProgress:h}}},H={class:"py-2"},K={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 flex gap-2 content-center justify-center"},Q={class:"mt-1 flex rounded-md shadow-sm w-4/5"},W={key:0,class:"max-w-7xl mx-auto sm:px-6 lg:px-8 text-red-500"},X={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Y={class:"bg-white shadow sm:rounded-t-lg flex justify-between space-x-2 items-end py-2 px-2 md:px-2"},Z={class:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full"},$={class:"col-span-1 sm:col-span-1"},ee={class:"py-2"},te={class:"mt-1 flex rounded-md shadow-sm"},se={key:0,class:"text-red-500"},oe={class:"py-2"},ne={class:"mt-1 flex rounded-md shadow-sm"},ae=["value"],re={key:0,class:"text-red-500"},le={class:"col-span-1 sm:col-span-1"},ie={class:"py-2"},de={class:"flex justify-between"},pe={class:"inline-flex text-sm font-medium text-gray-700"},me={key:0,class:"mt-1 flex rounded-md shadow-sm"},ce={key:0,class:"text-red-500"},ue={class:"py-2"},ge={class:"mt-1 flex rounded-md shadow-sm"},fe={key:0,class:"text-red-500"},xe={class:"col-span-1 sm:col-span-1"},ye={class:"py-2"},be={class:"mt-1 flex rounded-md shadow-sm"},he=["value"],_e={key:0,class:"text-red-500"},we={class:"py-2"},ke={class:"flex justify-between"},ve={class:"inline-flex text-sm font-medium text-gray-700"},Fe={key:0,class:"mt-1 flex rounded-md shadow-sm"},je={key:0,class:"text-red-500"},Ce={class:"col-span-1 sm:col-span-1"},Se={class:"py-2"},Ve={class:"mt-1 flex rounded-md shadow-sm"},Te=["value"],Ae={key:0,class:"text-red-500"},Ue={class:"mb-2 py-2 px-2 md:px-2 bg-white shadow rounded-b-lg flex justify-between"},Pe={class:"flex"},Me={class:"flex"},Oe={key:0,class:"bg-white overflow-auto shadow-xl sm:rounded-lg"},Ne={class:"min-w-full divide-y divide-gray-200"},Ee={class:"bg-white divide-y divide-gray-200 text-sm"},De={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},ze={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},Be={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},Le={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},Ge={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},Ie={class:"px-6 py-3 text-xs font-medium whitespace-nowrap"},qe={key:1,class:"w-full block mt-4"},Je={class:"text-xs text-gray-600"},Re={key:2},He={key:0,class:"fixed top-0 left-0 right-0 bottom-0 w-full h-screen z-50 overflow-hidden bg-gray-700 opacity-75 flex flex-col items-center justify-center"};function Ke(r,t,p,a,C,h){const n=k("multiselect"),_=k("pagination"),g=k("app-layout");return l(),B(g,null,{header:S(()=>t[14]||(t[14]=[e("h2",{class:"font-semibold text-xl text-white leading-tight"},"Announcement",-1)])),default:S(()=>[e("div",H,[e("div",K,[t[15]||(t[15]=e("label",{for:"name",class:"block text-sm font-bold text-gray-700 mt-4"},"Announcement Title ",-1)),e("div",Q,[c(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>a.createForm.name=o),name:"name",id:"name",class:"py-2.5 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Please Enter Announcement Name"},null,512),[[v,a.createForm.name]])])]),r.$page.props.errors.name?(l(),i("div",W,d(r.$page.props.errors.name),1)):m("",!0),e("div",X,[t[35]||(t[35]=e("label",{for:"name",class:"block text-sm font-bold text-indigo-700 mt-4"},"Announcement Preference",-1)),e("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[t[17]||(t[17]=e("label",{for:"sh_general",class:"block text-sm font-medium text-gray-700"},"General ",-1)),e("div",te,[t[16]||(t[16]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),c(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=o=>a.createForm.general=o),name:"sh_general",id:"sh_general",class:"pl-10 py-2.5 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300",placeholder:"Customer/Company Name etc.",tabindex:"1"},null,512),[[v,a.createForm.general]]),r.$page.props.errors.general?(l(),i("div",se,d(r.$page.props.errors.general),1)):m("",!0)])]),e("div",oe,[t[19]||(t[19]=e("label",{for:"sh_template",class:"block text-sm font-medium text-gray-700"},"Template ",-1)),e("div",ne,[c(e("select",{id:"sh_template","onUpdate:modelValue":t[2]||(t[2]=o=>a.createForm.template=o),name:"sh_template",class:"py-2.5 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",tabindex:"5",onChange:t[3]||(t[3]=(...o)=>a.template_change&&a.template_change(...o))},[t[18]||(t[18]=e("option",{value:"0"},"-Choose Template -",-1)),(l(!0),i(b,null,y(p.templates,o=>(l(),i("option",{key:o.id,value:o.id},d(o.name),9,ae))),128))],544),[[F,a.createForm.template]]),r.$page.props.errors.template?(l(),i("div",re,d(r.$page.props.errors.template),1)):m("",!0)])])]),e("div",le,[e("div",ie,[e("div",de,[t[21]||(t[21]=e("label",{for:"sh_package",class:"inline-flex text-sm font-medium text-gray-700"},"Package ",-1)),e("label",pe,[c(e("input",{class:"text-indigo-500 w-5 h-5 mr-2 focus:ring-indigo-400 focus:ring-opacity-25 border border-gray-300 rounded",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=o=>a.createForm.package_except=o)},null,512),[[V,a.createForm.package_except]]),t[20]||(t[20]=x(" Except "))])]),p.package_speed.length!==0?(l(),i("div",me,[j(n,{"deselect-label":"Selected already",options:p.package_speed,"track-by":"speed",label:"item_data",modelValue:a.createForm.package,"onUpdate:modelValue":t[5]||(t[5]=o=>a.createForm.package=o),"allow-empty":!0,multiple:!0,tabindex:"2"},null,8,["options","modelValue"]),r.$page.props.errors.package?(l(),i("div",ce,d(r.$page.props.errors.package),1)):m("",!0)])):m("",!0)]),e("div",ue,[t[22]||(t[22]=e("label",{for:"sh_type",class:"block text-sm font-medium text-gray-700"},"Type ",-1)),e("div",ge,[c(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=o=>a.createForm.type=o),name:"sh_type",id:"sh_type",class:"py-2.5 focus:ring-indigo-500 focus:border-indigo-500 flex-1 block w-full rounded-md sm:text-sm border-gray-300 uppercase",tabindex:"6",disabled:""},null,512),[[v,a.createForm.type]])]),r.$page.props.errors.type?(l(),i("div",fe,d(r.$page.props.errors.type),1)):m("",!0)])]),e("div",xe,[e("div",ye,[t[25]||(t[25]=e("label",{for:"sh_township",class:"block text-sm font-medium text-gray-700"},"Township ",-1)),e("div",be,[t[24]||(t[24]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),c(e("select",{id:"sh_township","onUpdate:modelValue":t[7]||(t[7]=o=>a.createForm.township=o),name:"sh_township",class:"pl-10 py-2.5 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",tabindex:"3"},[t[23]||(t[23]=e("option",{value:"0"},"-Choose Township -",-1)),(l(!0),i(b,null,y(p.townships,o=>(l(),i("option",{key:o.id,value:o.id},d(o.name),9,he))),128))],512),[[F,a.createForm.township]]),r.$page.props.errors.township?(l(),i("div",_e,d(r.$page.props.errors.township),1)):m("",!0)])]),e("div",we,[e("div",ke,[t[27]||(t[27]=e("label",{for:"sh_status",class:"block text-sm font-medium text-gray-700"},"Customer Status ",-1)),e("label",ve,[c(e("input",{class:"text-indigo-500 w-5 h-5 mr-2 focus:ring-indigo-400 focus:ring-opacity-25 border border-gray-300 rounded",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=o=>a.createForm.status_except=o)},null,512),[[V,a.createForm.status_except]]),t[26]||(t[26]=x(" Except "))])]),p.status.length!==0?(l(),i("div",Fe,[j(n,{"deselect-label":"Selected already",options:p.status,"track-by":"id",label:"name",modelValue:a.createForm.status,"onUpdate:modelValue":t[9]||(t[9]=o=>a.createForm.status=o),"allow-empty":!0,multiple:!0},null,8,["options","modelValue"]),r.$page.props.errors.status?(l(),i("div",je,d(r.$page.props.errors.status),1)):m("",!0)])):m("",!0)])]),e("div",Ce,[e("div",Se,[t[30]||(t[30]=e("label",{for:"sh_partner",class:"block text-sm font-medium text-gray-700"},"Project ",-1)),e("div",Ve,[t[29]||(t[29]=e("span",{class:"z-10 leading-snug font-normal absolute text-center text-gray-300 absolute bg-transparent rounded text-base items-center justify-center w-8 pl-3 py-2"},[e("i",{class:"fas fa-user"})],-1)),c(e("select",{id:"sh_partner","onUpdate:modelValue":t[10]||(t[10]=o=>a.createForm.partner=o),name:"sh_partner",class:"pl-10 py-2.5 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",tabindex:"4"},[t[28]||(t[28]=e("option",{value:"0"},"-Choose Project/Partner -",-1)),(l(!0),i(b,null,y(p.projects,o=>(l(),i("option",{key:o.id,value:o.id},d(o.name),9,Te))),128))],512),[[F,a.createForm.partner]]),r.$page.props.errors.partner?(l(),i("div",Ae,d(r.$page.props.errors.partner),1)):m("",!0)])])])])]),e("div",Ue,[e("div",Pe,[e("a",{onClick:t[11]||(t[11]=(...o)=>a.updateForm&&a.updateForm(...o)),class:"cursor-pointer inline-flex items-center px-4 py-2 bg-indigo-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:border-indigo-900 focus:ring focus:ring-indigo-300 disabled:opacity-25 transition"},t[31]||(t[31]=[x("1 Update "),e("i",{class:"ml-1 fa fa-save text-white",tabindex:"10"},null,-1)])),e("a",{onClick:t[12]||(t[12]=(...o)=>a.doSearch&&a.doSearch(...o)),class:"ml-2 cursor-pointer inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 active:bg-gray-900 focus:outline-none focus:border-gray-900 focus:ring focus:ring-gray-300 disabled:opacity-25 transition"},t[32]||(t[32]=[x("2 Preview "),e("i",{class:"ml-1 fa fa-search text-white",tabindex:"11"},null,-1)]))]),e("div",Me,[e("a",{onClick:t[13]||(t[13]=(...o)=>a.sendAnnouncement&&a.sendAnnouncement(...o)),class:"cursor-pointer inline-flex items-center px-4 py-2 bg-red-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 active:bg-red-900 focus:outline-none focus:border-red-900 focus:ring focus:ring-red-300 disabled:opacity-25 transition"},t[33]||(t[33]=[x("3 Send Announcement"),e("i",{class:"ml-1 -mt-1 fa fa-bullhorn text-white",tabindex:"12"},null,-1)]))])]),e("div",null,[p.customers.data?(l(),i("div",Oe,[e("table",Ne,[t[34]||(t[34]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Customer ID"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Order Date"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Package"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Township"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status")])],-1)),e("tbody",Ee,[(l(!0),i(b,null,y(p.customers.data,o=>(l(),i("tr",{key:o.id,class:G(" text-"+o.color)},[e("td",De,d(o.ftth_id),1),e("td",ze,d(o.order_date),1),e("td",Be,d(o.name),1),e("td",Le,d(o.package),1),e("td",Ge,d(o.township),1),e("td",Ie,d(o.status),1)],2))),128))])])])):m("",!0),p.customers.total?(l(),i("span",qe,[e("label",Je,d(p.customers.data.length)+" Customers in Current Page. Total Number of Customers : "+d(p.customers.total),1)])):m("",!0),p.customers.links?(l(),i("span",Re,[j(_,{class:"mt-4",links:p.customers.links},null,8,["links"])])):m("",!0)])])]),a.loading?(l(),i("div",He,t[36]||(t[36]=[e("div",{class:"loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12 mb-4"},null,-1),e("h2",{class:"text-center text-white text-xl font-semibold"},"Loading...",-1),e("p",{class:"w-1/3 text-center text-white"},"This may take a few seconds, please don't close this page.",-1)]))):m("",!0)]),_:1})}const tt=J(R,[["render",Ke]]);export{tt as default};
